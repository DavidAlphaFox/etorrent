<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- autogenerated by 'erl2html2'. -->
<html>
<head><title>/usr/home/jlouis/hacking/test_server/stdlib_test/c_SUITE.erl</title></head>

<body bgcolor="white" text="black" link="blue" vlink="purple" alink="red">
<pre>
    1:<i>%% ``The contents of this file are subject to the Erlang Public License,</i>
    2:<i>%% Version 1.1, (the "License"); you may not use this file except in</i>
    3:<i>%% compliance with the License. You should have received a copy of the</i>
    4:<i>%% Erlang Public License along with this software. If not, it can be</i>
    5:<i>%% retrieved via the world wide web at http://www.erlang.org/.</i>
    6:<i>%% </i>
    7:<i>%% Software distributed under the License is distributed on an "AS IS"</i>
    8:<i>%% basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See</i>
    9:<i>%% the License for the specific language governing rights and limitations</i>
<a name="10"></a>   10:<i>%% under the License.</i>
   11:<i>%% </i>
   12:<i>%% The Initial Developer of the Original Code is Ericsson Utvecklings AB.</i>
   13:<i>%% Portions created by Ericsson are Copyright 1999, Ericsson Utvecklings</i>
   14:<i>%% AB. All Rights Reserved.''</i>
   15:<i>%% </i>
   16:<i>%%     $Id$</i>
   17:<i>%%</i>
   18:-<b>module</b>(c_SUITE).
   19:-<b>export</b>([all/1]).
<a name="20"></a>   20:-<b>export</b>([c_1/1, c_2/1, c_3/1, c_4/1, memory/1]).
   21:
   22:-<b>include</b>("test_server.hrl").
   23:
   24:-<b>import</b>(c, [c/2]).
   25:
<a name=all>   26:<b>all</b></a>(doc) -&gt; ["Test cases for the 'c' module."];
<a name=all>   27:<b>all</b></a>(suite) -&gt;
   28:    [c_1, c_2, c_3, c_4, memory].
   29:
<a name="30"></a>   30:<i>%%% Write output to a directory other than current directory:</i>
   31:
<a name=c_1>   32:<b>c_1</b></a>(doc) -&gt;
   33:    ["Checks that c:c works also with option 'outdir' [ticket OTP-1209]."];
<a name=c_1>   34:<b>c_1</b></a>(suite) -&gt;
   35:    [];
<a name=c_1>   36:<b>c_1</b></a>(Config) when list(Config) -&gt;
   37:    ?line R = filename:join(?config(data_dir, Config), "m.erl"),
   38:    ?line W = ?config(priv_dir, Config),
   39:    ?line Result = c(R,[{outdir,W}]),
<a name="40"></a>   40:    ?line {ok, m} = Result.
   41:
<a name=c_2>   42:<b>c_2</b></a>(doc) -&gt;
   43:    ["Checks that c:c works also with option 'outdir' [ticket OTP-1209]."];
<a name=c_2>   44:<b>c_2</b></a>(suite) -&gt;
   45:    [];
<a name=c_2>   46:<b>c_2</b></a>(Config) when list(Config) -&gt;
   47:    ?line R = filename:join(?config(data_dir, Config), "m"),
   48:    ?line W = ?config(priv_dir, Config),
   49:    ?line Result = c(R,[{outdir,W}]),
<a name="50"></a>   50:    ?line {ok, m} = Result.
   51:
   52:
   53:<i>%%% Put results in current directory (or rather, change current dir</i>
   54:<i>%%% to the output dir):</i>
   55:
<a name=c_3>   56:<b>c_3</b></a>(doc) -&gt;
   57:    ["Checks that c:c works also with option 'outdir' (same as current"
   58:     "directory). [ticket OTP-1209]."];
<a name=c_3>   59:<b>c_3</b></a>(suite) -&gt;
<a name="60"></a>   60:    [];
<a name=c_3>   61:<b>c_3</b></a>(Config) when list(Config) -&gt;
   62:    ?line R = filename:join(?config(data_dir, Config), "m.erl"),
   63:    ?line W = ?config(priv_dir, Config),
   64:    ?line file:set_cwd(W),
   65:    ?line Result = c(R,[{outdir,W}]),
   66:    ?line {ok, m} = Result.
   67:
<a name=c_4>   68:<b>c_4</b></a>(doc) -&gt;
   69:    ["Checks that c:c works also with option 'outdir' (same as current"
<a name="70"></a>   70:     "directory). [ticket OTP-1209]."];
<a name=c_4>   71:<b>c_4</b></a>(suite) -&gt;
   72:    [];
<a name=c_4>   73:<b>c_4</b></a>(Config) when list(Config) -&gt;
   74:    ?line R = filename:join(?config(data_dir, Config), "m"),
   75:    ?line W = ?config(priv_dir, Config),
   76:    ?line file:set_cwd(W),
   77:    ?line Result = c(R,[{outdir,W}]),
   78:    ?line {ok, m} = Result.
   79:
<a name=memory><a name="80"></a>   80:<b>memory</b></a>(doc) -&gt;
   81:    ["Checks that c:memory/[0,1] returns consistent results."];
<a name=memory>   82:<b>memory</b></a>(suite) -&gt;
   83:    [];
<a name=memory>   84:<b>memory</b></a>(Config) when list(Config) -&gt;
   85:    ?line ML = c:memory(),
   86:    ?line T =  mget(total, ML),
   87:    ?line P =  mget(processes, ML),
   88:    ?line S =  mget(system, ML),
   89:    ?line A =  mget(atom, ML),
<a name="90"></a>   90:    ?line AU = mget(atom_used, ML),
   91:    ?line B =  mget(binary, ML),
   92:    ?line C =  mget(code, ML),
   93:    ?line E =  mget(ets, ML),
   94:    ?line T = P + S,
   95:    ?line if S &gt;= A + B + C + E -&gt; ok end,
   96:    ?line if A &gt;= AU -&gt; ok end,
   97:    ?line ok.
   98:
   99:<i>% Help function for c_SUITE:memory/1    </i>
<a name=mget><a name="100"></a>  100:<b>mget</b></a>(K, L) -&gt;
  101:    ?line {value,{K,V}} = lists:keysearch(K, 1, L),
  102:    ?line test_v(c:memory(K)), % Check that c:memory/1 also accept this
  103:                               % argument and returns an integer (usally
  104:                               % *not* the same as V).
  105:    ?line test_v(V).
  106:
  107:<i>% Help function for c_SUITE:memory/1    </i>
<a name=test_v>  108:<b>test_v</b></a>(V) when integer(V) -&gt;
  109:    ?line V.
</pre>
<hr size=1><i>The transformation of this file (110 lines) took 0.01 seconds</i><br>
</body>
</html>
